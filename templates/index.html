<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ñ—É—Ä–Ω–∞–ª –æ—Ü–µ–Ω–æ–∫</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h1 class="text-center mb-4">üìö –≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–π –∂—É—Ä–Ω–∞–ª –æ—Ü–µ–Ω–æ–∫</h1>
        
        <div class="card mb-4">
            <div class="card-body">
                <h5 class="card-title">–û –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏</h5>
                <p class="card-text">
                    –≠—Ç–æ –ø—Ä–æ—Å—Ç–æ–µ Flask-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —É—á–µ—Ç–∞ –æ—Ü–µ–Ω–æ–∫ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤.
                    –†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ –≤ —Ä–∞–º–∫–∞—Ö –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ–π –ø—Ä–∞–∫—Ç–∏–∫–∏.
                </p>
            </div>
        </div>

        <div class="row">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">–ü—Ä–æ—Å–º–æ—Ç—Ä –æ—Ü–µ–Ω–æ–∫</h5>
                        <p class="card-text">–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ –æ—Ü–µ–Ω–∫–∏ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤</p>
                        <a href="/grades" class="btn btn-primary">–ü–µ—Ä–µ–π—Ç–∏</a>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h5>
                        <p class="card-text">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ —É—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç–∏</p>
                        <button onclick="loadStats()" class="btn btn-success">–ü–æ–∫–∞–∑–∞—Ç—å</button>
                        <div id="stats" class="mt-3"></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="card mt-4">
            <div class="card-body">
                <h5 class="card-title">–î–æ–±–∞–≤–∏—Ç—å –æ—Ü–µ–Ω–∫—É</h5>
                <form id="addGradeForm">
                    <div class="mb-3">
                        <input type="text" class="form-control" id="studentName" placeholder="–§–ò–û —Å—Ç—É–¥–µ–Ω—Ç–∞" required>
                    </div>
                    <div class="mb-3">
                        <input type="text" class="form-control" id="subject" placeholder="–ü—Ä–µ–¥–º–µ—Ç" required>
                    </div>
                    <div class="mb-3">
                        <input type="number" class="form-control" id="grade" placeholder="–û—Ü–µ–Ω–∫–∞ (2-5)" min="2" max="5" required>
                    </div>
                    <button type="submit" class="btn btn-primary">–î–æ–±–∞–≤–∏—Ç—å</button>
                </form>
                <div id="message" class="mt-3"></div>
            </div>
        </div>
    </div>

    <script>
        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        async function loadStats() {
            const response = await fetch('/api/stats');
            const data = await response.json();
            
            document.getElementById('stats').innerHTML = `
                <p><strong>–í—Å–µ–≥–æ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤:</strong> ${data.total_students}</p>
                <p><strong>–í—Å–µ–≥–æ –æ—Ü–µ–Ω–æ–∫:</strong> ${data.total_grades}</p>
                <p><strong>–°—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª:</strong> ${data.average_grade}</p>
                <p><strong>–ü—Ä–µ–¥–º–µ—Ç—ã:</strong> ${data.subjects.join(', ')}</p>
            `;
        }

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π –æ—Ü–µ–Ω–∫–∏
        document.getElementById('addGradeForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const gradeData = {
                student_name: document.getElementById('studentName').value,
                subject: document.getElementById('subject').value,
                grade: parseInt(document.getElementById('grade').value)
            };

            const response = await fetch('/api/grades', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify(gradeData)
            });

            const result = await response.json();
            document.getElementById('message').innerHTML = `
                <div class="alert alert-success">
                    ${result.message}: ${gradeData.student_name} - ${gradeData.subject} (${gradeData.grade})
                </div>
            `;
            
            // –û—á–∏—Å—Ç–∫–∞ —Ñ–æ—Ä–º—ã
            document.getElementById('addGradeForm').reset();
        });
    </script>
</body>
</html>